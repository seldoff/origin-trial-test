<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Worker Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background-color: #0056b3; }
        #response { margin-top: 20px; padding: 10px; background-color: #f8f9fa; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Service Worker Demo</h1>
    <div id="status" class="status info">Checking service worker status...</div>
    
    <h2>Test Intercepted Requests</h2>
    <button onclick="testApiCall()">Test API Call</button>
    <button onclick="testImageRequest()">Test Image Request</button>
    <button onclick="testDataRequest()">Test Data Request</button>
    
    <div id="response"></div>

    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => {
                    console.log('Service Worker registered successfully:', registration);
                    document.getElementById('status').innerHTML = 
                        '<span class="success">✓ Service Worker registered successfully!</span>';
                })
                .catch(error => {
                    console.log('Service Worker registration failed:', error);
                    document.getElementById('status').innerHTML = 
                        '<span class="error">✗ Service Worker registration failed: ' + error + '</span>';
                });
        } else {
            document.getElementById('status').innerHTML = 
                '<span class="error">✗ Service Workers are not supported in this browser</span>';
        }

        // Test functions
        async function testApiCall() {
            try {
                const response = await fetch('/api/users');
                const data = await response.text();
                displayResponse('API Call', data);
            } catch (error) {
                displayResponse('API Call Error', error.message);
            }
        }

        async function testImageRequest() {
            try {
                const response = await fetch('/images/placeholder.jpg');
                const blob = await response.blob();
                displayResponse('Image Request', `Image loaded: ${blob.size} bytes, type: ${blob.type}`);
            } catch (error) {
                displayResponse('Image Request Error', error.message);
            }
        }

        async function testDataRequest() {
            try {
                const response = await fetch('/data/config.json');
                const data = await response.text();
                displayResponse('Data Request', data);
            } catch (error) {
                displayResponse('Data Request Error', error.message);
            }
        }

        function displayResponse(title, content) {
            document.getElementById('response').innerHTML = 
                `<h3>${title}</h3><pre>${content}</pre>`;
        }
    </script>
</body>
</html>
